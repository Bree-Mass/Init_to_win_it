!function(){"use strict";class t{constructor(t,e){this._data=t,this._cardSelector=e,this._email=t.email,this._location=t.location,this._desc=t.text,this._link=t.link,this._cardTemplate=e}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".donation-card").cloneNode(!0)}createCard(){return this._cardElement=this._getTemplate(),this._cardEmail=this._cardElement.querySelector(".donation-card__email"),this._cardLocation=this._cardElement.querySelector(".donation-card__location"),this._cardDonation=this._cardElement.querySelector(".donation-card__description"),this._cardImage=this._cardElement.querySelector(".donation-card__image"),this._cardEmail.textContent=`Email: ${this._email}`,this._cardLocation.textContent=`Location: ${this._location}`,this._cardDonation.textContent=`Donation: ${this._desc}`,this._cardImage.src=this._link,this._cardImage.alt=this._desc,this._cardElement}}class e{constructor(t,e){this._renderer=t,this._container=document.querySelector(e)}renderItems(t){t.forEach((t=>{this.addItem(t)}))}addItem(t){const e=this._renderer(t);this._container.prepend(e)}clearItems(){if(this._cards=this._container.querySelectorAll(".charity-card"),null!==this._cards)for(var t=0;t<this._cards.length;t++)this._cards[t].remove()}}class r{constructor(t,e){this._data=t,this._name=t.name,this._profileUrl=t.profileUrl,this._logoUrl=t.logoUrl,this._location=t.location,this._cardSelector=e}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".charity-card").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._element.querySelector(".charity-card__name").textContent=this._name,this._element.querySelector(".charity-card__location").textContent=this._location,this._element.querySelector(".charity-card__url").href=this._profileUrl,this._element}}class s{constructor(t){let{popupSelector:e}=t;this._popupElement=document.querySelector(e),this._popupCloseButton=this._popupElement.querySelector(".popup__close-button"),this._closeByEscape=t=>{"Escape"===t.key&&this.close()}}open(){this._popupElement.classList.add("donation__popup_opened"),document.addEventListener("keydown",this._closeByEscape)}close(){this._popupElement.classList.remove("donation__popup_opened"),document.removeEventListener("keydown",this._closeByEscape)}setEventListeners(){this._popupElement.addEventListener("click",(t=>{t.target!==this._popupCloseButton&&t.target!==this._popupElement||this.close()}))}}const o=document.querySelector(".donate__button"),i=new class{constructor(t){let{baseUrl:e,apiKey:r}=t;this._baseUrl=e,this._apiKey=r}_request(t){return fetch(t).then(this.renderResult)}renderResult(t){return t.ok?t.json():Promise.reject(`'Error:' ${t.status}`)}getInfo(t){return fetch(`${this._baseUrl}search/causes=${t}?apiKey=${this._apiKey}`).then(this.renderResult)}}({baseUrl:"https://partners.every.org/v0.2/",apiKey:"pk_live_51295acbffe33d27ac313b33feb97d63"});new class{constructor(t,e){this._formElement=document.querySelector(t),this._form=this._formElement.querySelector(".charities__form"),this._formBtn=this._formElement.querySelector(".charities__button"),this._input=this._formElement.querySelector(".charities__input"),this._handleFormSubmit=e}_getCause(){for(var t,e=document.getElementsByName("cause"),r=0;r<e.length;r++)e[r].checked&&(t=e[r].value);return t}setEventListeners(){this._formBtn.addEventListener("click",(t=>{t.preventDefault();const e=this._getCause();this._handleFormSubmit(e),this._form.reset()}))}}(".charities",(function(t){n.clearItems(),i.getInfo(t).then((t=>{n.renderItems(t.nonprofits)})).catch(console.error)})).setEventListeners();const n=new e((function(t){return new r(t,"#charity-card-template").generateCard()}),"#charities-container"),a=new class extends s{constructor(t,e){super({popupSelector:e}),this._donationForm=this._popupElement.querySelector(".donation-form"),this._formSubmit=t}_getInputValues(){const t={};return this._donationForm.querySelectorAll(".donation-form__input").forEach((e=>{t[e.name]=e.value})),t}close(){this._donationForm.reset(),super.close()}setEventListeners(){this._donationForm.addEventListener("submit",(t=>{t.preventDefault();const e=this._getInputValues();this._formSubmit(e),this.close()})),super.setEventListeners()}}((t=>{c.addItem(t)}),".donation__popup"),c=new e((e=>new t(e,"#donation-card__template").createCard()),".donations__gallery");a.setEventListeners(),o.addEventListener("click",(()=>{a.open(),_.resetValidation()}));const l=document.querySelector("#donation-form"),_=new class{constructor(t,e){this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=e}_showInputError(t,e){const r=document.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),r.textContent=e,r.classList.add(this._errorClass)}_hideInputError(t){const e=document.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.classList.remove(this._errorClass),e.textContent=""}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}resetValidation(){this.toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}disableSubmitButton=()=>{const t=this._formElement.querySelector(this._submitButtonSelector);t.classList.add(this._inactiveButtonClass),t.disabled=!0};_setEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this.toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}}({formSelector:".donation-form",inputSelector:".donation-form__input",submitButtonSelector:".donation-form__submit-button",inactiveButtonClass:"donation-form__submit-button_disabled",inputErrorClass:"donation-form__input_type_error",errorClass:"donation-form__error_visible"},l);_.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFBLEdBQ0U5SixLQUFLNEYsYUFBYXpCLGlCQUFpQixVQUFXTixJQUM1Q0EsRUFBSXlDLGdCQUFnQixJQUV0QnRHLEtBQUsySixvQkFDUCxHTHZGMEMsQ0FDMUM3QixhQUFjLGlCQUNkRSxjQUFlLHdCQUNmRSxxQkFBc0IsZ0NBQ3RCRSxvQkFBcUIsd0NBQ3JCRSxnQkFBaUIsa0NBQ2pCRSxXQUFZLGdDQ3dEWmIsR0FFRkYsRUFBc0JxQyxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvRG9uYXRpb25DYXJkLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9jb2RlX2phbS8uL3NyYy9jb21wb25lbnRzL0NoYXJpdHlDYXJkLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvcG9wdXAuanMiLCJ3ZWJwYWNrOi8vY29kZV9qYW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvQ2hhcml0aWVzLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvRG9uYXRpb25zUG9wdXAuanMiLCJ3ZWJwYWNrOi8vY29kZV9qYW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIERvbmF0aW9uQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFRlbXBsYXRlKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRUZW1wbGF0ZTtcclxuICAgIHRoaXMuX2VtYWlsID0gZGF0YS5lbWFpbDtcclxuICAgIHRoaXMuX2xvY2F0aW9uID0gZGF0YS5sb2NhdGlvbjtcclxuICAgIHRoaXMuX2Rlc2MgPSBkYXRhLnRleHQ7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fY2FyZFRlbXBsYXRlID0gY2FyZFRlbXBsYXRlO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmRvbmF0aW9uLWNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuICBjcmVhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVtYWlsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5kb25hdGlvbi1jYXJkX19lbWFpbFwiKTtcclxuICAgIHRoaXMuX2NhcmRMb2NhdGlvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmRvbmF0aW9uLWNhcmRfX2xvY2F0aW9uXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9jYXJkRG9uYXRpb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5kb25hdGlvbi1jYXJkX19kZXNjcmlwdGlvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5kb25hdGlvbi1jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRFbWFpbC50ZXh0Q29udGVudCA9IGBFbWFpbDogJHt0aGlzLl9lbWFpbH1gO1xyXG4gICAgdGhpcy5fY2FyZExvY2F0aW9uLnRleHRDb250ZW50ID0gYExvY2F0aW9uOiAke3RoaXMuX2xvY2F0aW9ufWA7XHJcbiAgICB0aGlzLl9jYXJkRG9uYXRpb24udGV4dENvbnRlbnQgPSBgRG9uYXRpb246ICR7dGhpcy5fZGVzY31gO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX2Rlc2M7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBlbGVtZW50U2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnRTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICAvLyByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gIC8vICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gIC8vICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAvLyAgIH0pO1xyXG4gIC8vIH1cclxuICAvLyBhZGRJdGVtKGl0ZW0pIHtcclxuICAvLyAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gIC8vIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5hZGRJdGVtKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIGNvbnN0IG5ld0NhcmQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKG5ld0NhcmQpO1xyXG4gIH1cclxuXHJcbiAgY2xlYXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2NhcmRzID0gdGhpcy5fY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2hhcml0eS1jYXJkXCIpO1xyXG4gICAgaWYgKHRoaXMuX2NhcmRzICE9PSBudWxsKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2FyZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB0aGlzLl9jYXJkc1tpXS5yZW1vdmUoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDaGFyaXR5Q2FyZCB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9wcm9maWxlVXJsID0gZGF0YS5wcm9maWxlVXJsO1xyXG4gICAgdGhpcy5fbG9nb1VybCA9IGRhdGEubG9nb1VybDtcclxuICAgIHRoaXMuX2xvY2F0aW9uID0gZGF0YS5sb2NhdGlvbjtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IF9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jaGFyaXR5LWNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fbmFtZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2hhcml0eS1jYXJkX19sb2NhdGlvblwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX2xvY2F0aW9uO1xyXG4gICAgLy8gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fbG9nb1wiKS5zcmMgPSB0aGlzLl9sb2dvVXJsO1xyXG4gICAgLy8gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fbG9nb1wiKS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fdXJsXCIpLmhyZWYgPSB0aGlzLl9wcm9maWxlVXJsO1xyXG5cclxuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuX2VsZW1lbnQpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cENsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLnBvcHVwX19jbG9zZS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2Nsb3NlQnlFc2NhcGUgPSAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJkb25hdGlvbl9fcG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fY2xvc2VCeUVzY2FwZSk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJkb25hdGlvbl9fcG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fY2xvc2VCeUVzY2FwZSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldCA9PT0gdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbiB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQgPT09IHRoaXMuX3BvcHVwRWxlbWVudFxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgZG9uYXRpb25Gb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmRvbmF0aW9uLWZvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5kb25hdGlvbi1mb3JtX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5kb25hdGlvbi1mb3JtX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJkb25hdGlvbi1mb3JtX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImRvbmF0aW9uLWZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImRvbmF0aW9uLWZvcm1fX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBjaGFyaXRpZXNGb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmNoYXJpdGllc19fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmNoYXJpdGllc19faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuY2hhcml0aWVzX19idXR0b25cIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiY2hhcml0aWVzLWZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImNoYXJpdGllcy1mb3JtX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZG9uYXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kb25hdGVfX2J1dHRvblwiKTtcclxuIiwiLy8gSU1QT1JUU1xyXG5pbXBvcnQgRG9uYXRpb25DYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0RvbmF0aW9uQ2FyZC5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbmltcG9ydCBDaGFyaXRpZXMgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2hhcml0aWVzLmpzXCI7XHJcbmltcG9ydCBDaGFyaXR5Q2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DaGFyaXR5Q2FyZC5qc1wiO1xyXG5pbXBvcnQgRG9uYXRpb25zUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvRG9uYXRpb25zUG9wdXAuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHtcclxuICBkb25hdGlvbkZvcm1WYWxpZGF0aW9uQ29uZmlnLFxyXG4gIGRvbmF0ZUJ1dHRvbixcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5cclxuLy9BUEkgSU5TVEFOVElBVElPTlxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vcGFydG5lcnMuZXZlcnkub3JnL3YwLjIvXCIsXHJcbiAgYXBpS2V5OiBcInBrX2xpdmVfNTEyOTVhY2JmZmUzM2QyN2FjMzEzYjMzZmViOTdkNjNcIixcclxufSk7XHJcblxyXG4vL0NIQVJJVFkgRk9STVxyXG5jb25zdCBjaGFyaXR5Rm9ybSA9IG5ldyBDaGFyaXRpZXMoXCIuY2hhcml0aWVzXCIsIGhhbmRsZUNoYXJpdHlGb3JtU3VibWl0KTtcclxuY2hhcml0eUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuZnVuY3Rpb24gaGFuZGxlQ2hhcml0eUZvcm1TdWJtaXQoZGF0YSkge1xyXG4gIGNoYXJpdHlDYXJkTGlzdC5jbGVhckl0ZW1zKCk7XHJcbiAgYXBpXHJcbiAgICAuZ2V0SW5mbyhkYXRhKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBjaGFyaXR5Q2FyZExpc3QucmVuZGVySXRlbXMocmVzLm5vbnByb2ZpdHMpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVDaGFyaXR5Q2FyZChkYXRhKSB7XHJcbiAgY29uc3QgY2hhcml0eUNhcmQgPSBuZXcgQ2hhcml0eUNhcmQoZGF0YSwgXCIjY2hhcml0eS1jYXJkLXRlbXBsYXRlXCIpO1xyXG4gIHJldHVybiBjaGFyaXR5Q2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5jb25zdCBjaGFyaXR5Q2FyZExpc3QgPSBuZXcgU2VjdGlvbihjcmVhdGVDaGFyaXR5Q2FyZCwgXCIjY2hhcml0aWVzLWNvbnRhaW5lclwiKTtcclxuXHJcbi8vIERPTkFUSU9ORk9STVxyXG5jb25zdCBjcmVhdGVEb25hdGlvbkNhcmQgPSAoY2FyZERhdGEpID0+IHtcclxuICBjb25zdCBuZXdDYXJkID0gbmV3IERvbmF0aW9uQ2FyZChjYXJkRGF0YSwgXCIjZG9uYXRpb24tY2FyZF9fdGVtcGxhdGVcIik7XHJcbiAgcmV0dXJuIG5ld0NhcmQuY3JlYXRlQ2FyZCgpO1xyXG59O1xyXG5jb25zdCBkb25hdGlvblJlbmRlcmVyID0gKGlucHV0RGF0YSkgPT4ge1xyXG4gIHNlY3Rpb25Eb25hdGlvbnMuYWRkSXRlbShpbnB1dERhdGEpO1xyXG59O1xyXG5jb25zdCBkb25hdGlvbnNQb3B1cCA9IG5ldyBEb25hdGlvbnNQb3B1cChkb25hdGlvblJlbmRlcmVyLCBcIi5kb25hdGlvbl9fcG9wdXBcIik7XHJcbmNvbnN0IHNlY3Rpb25Eb25hdGlvbnMgPSBuZXcgU2VjdGlvbihjcmVhdGVEb25hdGlvbkNhcmQsIFwiLmRvbmF0aW9uc19fZ2FsbGVyeVwiKTtcclxuXHJcbi8vIENMQVNTIE1FVEhPRCBDQUxMU1xyXG5kb25hdGlvbnNQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gRVZFTlQgTElTVEVORVJTXHJcbmRvbmF0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGRvbmF0aW9uc1BvcHVwLm9wZW4oKTtcclxuICBkb25hdGlvbkZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuLy9GT1JNIFZBTElEQVRJT05cclxuY29uc3QgZG9uYXRpb25Gb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZG9uYXRpb24tZm9ybVwiKTtcclxuY29uc3QgZG9uYXRpb25Gb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0aW9uKFxyXG4gIGRvbmF0aW9uRm9ybVZhbGlkYXRpb25Db25maWcsXHJcbiAgZG9uYXRpb25Gb3JtRWxlbWVudFxyXG4pO1xyXG5kb25hdGlvbkZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgYXBpS2V5IH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5fYXBpS2V5ID0gYXBpS2V5O1xyXG4gIH1cclxuXHJcbiAgX3JlcXVlc3QodXJsKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsKS50aGVuKHRoaXMucmVuZGVyUmVzdWx0KTtcclxuICB9XHJcblxyXG4gIHJlbmRlclJlc3VsdChyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYCdFcnJvcjonICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vICAgZ2V0SW5mbyhjaXR5KSB7XHJcbiAgLy8gICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2FwaS9vcmdhbml6YXRpb25zL3NlYXJjaC86JHtjaXR5fWAsIHtcclxuICAvLyAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gIC8vICAgICB9KTtcclxuICAvLyAgIH1cclxuXHJcbiAgZ2V0SW5mbyhjYXVzZSkge1xyXG4gICAgcmV0dXJuIGZldGNoKFxyXG4gICAgICBgJHt0aGlzLl9iYXNlVXJsfXNlYXJjaC9jYXVzZXM9JHtjYXVzZX0/YXBpS2V5PSR7dGhpcy5fYXBpS2V5fWBcclxuICAgICkudGhlbih0aGlzLnJlbmRlclJlc3VsdCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENoYXJpdGllcyB7XHJcbiAgY29uc3RydWN0b3IoZm9ybUVsZW1lbnQsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihmb3JtRWxlbWVudCk7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jaGFyaXRpZXNfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9mb3JtQnRuID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jaGFyaXRpZXNfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX2lucHV0ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jaGFyaXRpZXNfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0Q2F1c2UoKSB7XHJcbiAgICB2YXIgZWxlbWVudHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZShcImNhdXNlXCIpO1xyXG4gICAgdmFyIGNhdXNlO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAoZWxlbWVudHNbaV0uY2hlY2tlZCkge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGVsZW1lbnRzW2ldKTtcclxuICAgICAgICBjYXVzZSA9IGVsZW1lbnRzW2ldLnZhbHVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY2F1c2U7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Zvcm1CdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNvbnN0IHNlbGVjdGVkQ2F1c2UgPSB0aGlzLl9nZXRDYXVzZSgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHNlbGVjdGVkQ2F1c2UpO1xyXG4gICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL3BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERvbmF0aW9uc1BvcHVwIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKGZvcm1TdWJtaXQsIHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX2RvbmF0aW9uRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmRvbmF0aW9uLWZvcm1cIik7XHJcbiAgICB0aGlzLl9mb3JtU3VibWl0ID0gZm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICBjb25zdCBpbnB1dEVsZW1lbnRzID0gdGhpcy5fZG9uYXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXHJcbiAgICAgIFwiLmRvbmF0aW9uLWZvcm1fX2lucHV0XCJcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9kb25hdGlvbkZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZG9uYXRpb25Gb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICB0aGlzLl9mb3JtU3VibWl0KGlucHV0VmFsdWVzKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdGlvbiB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBzZXR0aW5ncy5mb3JtU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgX2Vycm9yRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBfZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgX2Vycm9yRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBfZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBfZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlU3VibWl0QnV0dG9uID0gKCkgPT4ge1xyXG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJEb25hdGlvbkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkVGVtcGxhdGUiLCJ0aGlzIiwiX2RhdGEiLCJfY2FyZFNlbGVjdG9yIiwiX2VtYWlsIiwiZW1haWwiLCJfbG9jYXRpb24iLCJsb2NhdGlvbiIsIl9kZXNjIiwidGV4dCIsIl9saW5rIiwibGluayIsIl9jYXJkVGVtcGxhdGUiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY3JlYXRlQ2FyZCIsIl9jYXJkRWxlbWVudCIsIl9jYXJkRW1haWwiLCJfY2FyZExvY2F0aW9uIiwiX2NhcmREb25hdGlvbiIsIl9jYXJkSW1hZ2UiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsIlNlY3Rpb24iLCJyZW5kZXJlciIsImVsZW1lbnRTZWxlY3RvciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW1zIiwiZm9yRWFjaCIsIml0ZW0iLCJhZGRJdGVtIiwibmV3Q2FyZCIsInByZXBlbmQiLCJjbGVhckl0ZW1zIiwiX2NhcmRzIiwicXVlcnlTZWxlY3RvckFsbCIsImkiLCJsZW5ndGgiLCJyZW1vdmUiLCJDaGFyaXR5Q2FyZCIsImNhcmRTZWxlY3RvciIsIl9uYW1lIiwibmFtZSIsIl9wcm9maWxlVXJsIiwicHJvZmlsZVVybCIsIl9sb2dvVXJsIiwibG9nb1VybCIsImdlbmVyYXRlQ2FyZCIsIl9lbGVtZW50IiwiaHJlZiIsIlBvcHVwIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX3BvcHVwQ2xvc2VCdXR0b24iLCJfY2xvc2VCeUVzY2FwZSIsImV2dCIsImtleSIsImNsb3NlIiwib3BlbiIsImNsYXNzTGlzdCIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJkb25hdGVCdXR0b24iLCJhcGkiLCJiYXNlVXJsIiwiYXBpS2V5IiwiX2Jhc2VVcmwiLCJfYXBpS2V5IiwiX3JlcXVlc3QiLCJ1cmwiLCJmZXRjaCIsInRoZW4iLCJyZW5kZXJSZXN1bHQiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5mbyIsImNhdXNlIiwiZm9ybUVsZW1lbnQiLCJoYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm1FbGVtZW50IiwiX2Zvcm0iLCJfZm9ybUJ0biIsIl9pbnB1dCIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldENhdXNlIiwiZWxlbWVudHMiLCJnZXRFbGVtZW50c0J5TmFtZSIsImNoZWNrZWQiLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0Iiwic2VsZWN0ZWRDYXVzZSIsInJlc2V0IiwiY2hhcml0eUNhcmRMaXN0Iiwibm9ucHJvZml0cyIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiZG9uYXRpb25zUG9wdXAiLCJmb3JtU3VibWl0Iiwic3VwZXIiLCJfZG9uYXRpb25Gb3JtIiwiX2Zvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwiaW5wdXREYXRhIiwic2VjdGlvbkRvbmF0aW9ucyIsImNhcmREYXRhIiwiZG9uYXRpb25Gb3JtVmFsaWRhdG9yIiwicmVzZXRWYWxpZGF0aW9uIiwiZG9uYXRpb25Gb3JtRWxlbWVudCIsInNldHRpbmdzIiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsIl9lcnJvckVsZW1lbnQiLCJpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0TGlzdCIsInNvbWUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9idXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJkaXNhYmxlU3VibWl0QnV0dG9uIiwiYnV0dG9uRWxlbWVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9